@{
    ViewData["Title"] = "Print Labels";
}
@model IEnumerable<PartsAndLocation>

<div class="text-center">
    <h1 class="display-4">Print Labels</h1>
</div>

<div class="label-container">
    <div class="label-outline-left">
        <div class="label-entry">
            <form asp-controller="Home" asp-action="Index" method="get">
                <div class="form-group mb-3">
                    <label for="printNum">Part Number:</label>
                    <input type="text" 
                           name="printNum" 
                           id="printNum" 
                           class="form-control" 
                           placeholder="Enter Part Number" 
                           autofocus 
                           value="@ViewContext.HttpContext.Request.Query["printNum"]" />
                </div>
                <button class="submit_button" type="submit">Search Part</button>
            </form>

            <hr style="border-color: goldenrod; margin: 20px 0;" />

            <div class="form-group mb-3">
                <label for="Loc">Location:</label>
                <input type="text" 
                       id="Loc" 
                       class="form-control" 
                       placeholder="Enter or Edit Location" />
            </div>

            <div class="form-group mb-3">
                <label for="FIFO">FIFO:</label>
                <input type="text" 
                       id="FIFO" 
                       class="form-control" 
                       placeholder="Enter FIFO Date" />
            </div>

            <div class="form-group mb-3">
                <label for="QTYLbl">Labels:</label>
                <input type="number" 
                       id="QTYLbl" 
                       class="form-control" 
                       placeholder="Enter Label QTY" 
                       min="1" 
                       value="1" />
            </div>

            <div class="form-group mb-3">
                @if (Model != null && Model.Any())
                {
                    <form id="printLabelForm" asp-controller="Home" asp-action="DownloadLabel" method="post" style="display: none;">
                        @Html.AntiForgeryToken()
                        <input type="hidden" name="printNum" id="printNumHidden" value="@ViewContext.HttpContext.Request.Query["printNum"]" />
                        <input type="hidden" name="qty" id="qtyHidden" value="1" />
                        <input type="hidden" name="fifo" id="fifoHidden" />
                        <input type="hidden" name="bin" id="binHidden" />
                    </form>
                    <button type="button" 
                            id="btnPrintLabels" 
                            class="submit_button" 
                            style="width: 100%;">
                        Print Labels
                    </button>
                }
                else
                {
                    <button type="button" 
                            id="btnPrintLabels" 
                            class="submit_button" 
                            style="width: 100%;"
                            disabled>
                        Print Labels (Search for a part first)
                    </button>
                }
            </div>
        </div>
    </div>

    <div class="label-outline-right">
        <div class="label">
            @if (Model == null || !Model.Any())
            {
                <div class="text-center p-3">
                    <p><strong>Part Number</strong></p>
                    <p>Description</p>
                    <p>Bin</p>
                    <p>FIFO</p>
                </div>
            }
            else
            {
                @foreach (var item in Model)
                {
                    <div class="p-3">
                        <p id="lblPartNum" style="font-size: large; font-weight: bold; margin-bottom: 5px;">
                            @item.Material
                        </p>
                        <p id="lblDesc" style="font-size: small; margin-bottom: 5px;">
                            @item.Description
                        </p>
                        <p id="lblLocation" style="margin-bottom: 5px;">
                            <strong>Bin:</strong> @item.Bin
                        </p>
                        <p id="lblFIFO" style="margin-bottom: 0;">
                            <strong>FIFO:</strong> @DateTime.Now.ToString("MMMM yyyy")
                        </p>
                    </div>
                }
            }
        </div>
        @if (ViewBag.url != null)
        {
            <div class="mt-3 text-center">
                <img src="@ViewBag.url" alt="Label Preview" class="img-fluid" />
            </div>
        }
    </div>
</div>

@section Scripts {
    <script src="~/JS/Script.js" asp-append-version="true"></script>
}